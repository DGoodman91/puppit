integrations:
- name: exporter-tests
  manifest: site-exporters.pp
  fixtures:
    modules:
      - name: prometheus
        path: ../../prometheus
    files:
      - files/test1
      - files/test2
  goss-tests:
    # ensure the prometheus user has been added
    user:
      prometheus:
        exists: true
        groups:
          - prometheus
        home: /home/prometheus
        shell: /sbin/nologin
- name: server-tests
  manifest: site-server.pp
  fixtures:
    modules:
      - name: prometheus
        path: ../../prometheus
    files:
  goss-tests:
    file:
      # confirm that the prometheus binary is in place
      /home/prometheus/prometheus-2.27.1.linux-amd64/prometheus:
        exists: true
        mode: "0755"
        filetype: file